

# Flow.payment 구독 관리 시스템 프로젝트 리포트

**Flow.payment**는 Next.js와 Express/Prisma를 결합하여 구축된 전문 구독 관리 대시보드입니다. 실시간 데이터 대시보드부터 세밀한 플랜 관리까지, 효율적인 구독 비즈니스 운영을 위한 핵심 기능을 통합적으로 제공합니다.

## 주요 핵심 기능

### 1. 지능형 대시보드 (Dashboard)

* **실시간 지표 분석**: 총 수익, 활성 구독 수, 이탈률 등 주요 비즈니스 KPI를 실시간으로 모니터링합니다.
* **시각적 통계**: 플랜별 분포를 차트로 제공하여 인기 상품을 직관적으로 파악할 수 있습니다.
* **통합 검색 & 관리**: 스마트 검색 기능과 페이지네이션이 적용된 청구서 목록을 통해 대규모 데이터도 쉽게 관리합니다.

### 2. 고도화된 구독 관리 (Subscription Management)

* **완전한 CRUD**: 구독 플랜의 생성부터 비활성화까지 전 과정을 관리자 페이지에서 처리합니다.
* **데이터 무결성 보호**: 외래 키 제약 조건을 활용하여 실제 사용 중인 플랜이 실수로 삭제되지 않도록 안전장치를 마련했습니다.
* **동적 리소스 로딩**: 구독 추가 시 백엔드와 연동하여 현재 활성화된 플랜만 선택지에 노출합니다.

### 3. 사용자 중심 UI/UX

* **커스텀 모달 시스템**: 브라우저 기본 알림창을 대신하여 디자인 일관성을 유지하는 전역 모달(Alert/Confirm)을 적용했습니다.
* **반응형 레이아웃**: 접이식 사이드바와 최적화된 타이포그래피로 모바일과 데스크톱 모두에서 쾌적한 환경을 제공합니다.

---

## 기술 스택 (Tech Stack)

| 구분 | 기술 환경 |
| --- | --- |
| **Frontend** | Next.js 14 (App Router), TypeScript, CSS Modules |
| **Backend** | Node.js, Express.js, TypeScript |
| **Database** | PostgreSQL, Prisma ORM |
| **State/Comm.** | React Context (Modal), Axios |

---

## 📂 프로젝트 구조

```text
c:\flow
├── client/              # Next.js 프론트엔드 (Port: 3000)
│   ├── src/app/
│   │   ├── components/  # 공통 UI 컴포넌트
│   │   ├── context/     # 전역 상태 (ModalContext)
│   │   └── subscriptions/ # 플랜 관리 페이지
└── server/              # Express 백엔드 (Port: 3001)
    ├── prisma/          # 스키마 및 시드 데이터
    └── src/
        ├── controllers/ # 비즈니스 로직
        └── routes/      # API 엔드포인트

```

---

## 최근 업데이트 사항

### 시스템 안정성 및 보안

* **인증 기반 접근 제어**: 주요 서비스 접근 시 로그인 여부를 체크하여 비로그인 사용자를 리다이렉트 처리합니다.
* **환경 변수 최적화**: API URL 등 민감 정보를 환경 변수로 관리하여 유지보수성과 보안을 강화했습니다.
* **데이터 표준화**: 모든 통화(Currency) 단위를 DB 기반으로 일관성 있게 표시합니다.

### 관리자 경험(AX) 개선

* **디자인 시스템 통합**: 송장, 고객, 구독 테이블의 UI를 통일하여 시각적 연속성을 확보했습니다.
* **성능 최적화**: 목록 조회 시 페이지네이션을 도입하고, 테이블 내 액션 UI를 직관적으로 개선했습니다.

### 디자인 및 접근성 수정

* **UX 디테일**: 사이드바 메뉴 활성 상태 표시, 슬라이더 배경 버그 수정, 완료 팝업 가독성 향상 등을 진행했습니다.
* **웹 접근성**: 폼 요소 및 셀렉트 박스의 누락된 속성을 수정하여 표준을 준수합니다.

## 최근 주요 개발 내역 (2026-01-23)

이번 업데이트에서는 시스템의 데이터 무결성과 API 구조의 일관성을 강화하는 데 집중했습니다.

| 구분 | 주요 개발 항목 | 상세 내용 & 기술적 특징 |
| :--- | :--- | :--- |
| **결제 로직** | **결제 대기(WAITING) 도입** | • 신규 구독 `WAITING` 상태 시작<br>• 첫 결제일 = **Today**로 자동 설정<br>• UI에 `결제 대기` 배지 적용 |
| **데이터 무결성** | **Cascade Delete 적용** | • 구독 삭제 시 연관 `Invoice` 선삭제 (Transaction)<br>• P2003 FK 제약 조건 오류 해결 |
| **동기화** | **양방향 상태 동기화** | • 고객 `INACTIVE` ↔ 구독 `INACTIVE` 자동 전환<br>• 구독 재활성화 시 고객 계정 자동 복구 |
| **아키텍처** | **API 폴더 구조 개편** | • 기능별 `add`, `modify`, `delete` 폴더 분리<br>• RESTful 라우팅 구조 표준화 (`/api/v1/...`) |

---

## 시작하기

1. **Backend**: `cd server` → `npm install` → `npm run build` → `npm start`
2. **Frontend**: `cd client` → `npm install` → `npm run dev`
3. **접속**: 브라우저에서 `http://localhost:3000` 열기

---